function showSection(id){document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));document.getElementById(id).classList.add('active');}
function addTimelineItem(containerId){let div=document.createElement('div');div.className='timeline-item';div.innerHTML=`<input placeholder='時間'><input placeholder='地點' oninput='updateMap(this)'><textarea placeholder='備註'></textarea><iframe width='100%' height='200' style='border:0;' loading='lazy'></iframe>`;document.getElementById(containerId).appendChild(div);}
function updateMap(input){let iframe=input.parentElement.querySelector('iframe');iframe.src=`https://www.google.com/maps?q=${encodeURIComponent(input.value)}&output=embed`;}
function getWeather(){let city=document.getElementById('city').value||'Tokyo';fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=YOUR_API_KEY&units=metric&lang=ja`).then(r=>r.json()).then(d=>{let advice=d.main.temp<10?'穿厚外套':'輕便衣物';document.getElementById('weatherResult').innerHTML=`${d.name}: ${d.main.temp}°C, ${d.weather[0].description}<br>建議: ${advice}`;});}
const shoppingData={"化妝品":[],"食物":[],"日用品":[]};function addShopping(){let cat=document.getElementById('shoppingCategory').value;let item=document.getElementById('shoppingInput').value;if(item){shoppingData[cat].push(item);renderShopping();document.getElementById('shoppingInput').value='';}}
function renderShopping(){let container=document.getElementById('shoppingLists');container.innerHTML='';for(let cat in shoppingData){let div=document.createElement('div');div.innerHTML=`<h3>${cat}</h3>`;shoppingData[cat].forEach((item,i)=>{let li=document.createElement('li');li.textContent=item;li.onclick=function(){shoppingData[cat].splice(i,1);renderShopping();};div.appendChild(li);});container.appendChild(div);}}
function addPacking(){let item=document.getElementById('packingInput').value;if(item){let li=document.createElement('li');li.draggable=true;li.innerHTML=`<span>${item}</span><input type='checkbox'>`;li.ondragstart=function(){li.classList.add('dragging');};li.ondragend=function(){li.classList.remove('dragging');};document.getElementById('packingList').appendChild(li);document.getElementById('packingInput').value='';}}
const packingList=document.getElementById('packingList');packingList.addEventListener('dragover',e=>{e.preventDefault();const dragging=document.querySelector('.dragging');const afterElement=getDragAfterElement(packingList,e.clientY);if(afterElement==null){packingList.appendChild(dragging);}else{packingList.insertBefore(dragging,afterElement);}});
function getDragAfterElement(container,y){const els=[...container.querySelectorAll('li:not(.dragging)')];return els.reduce((closest,child)=>{const box=child.getBoundingClientRect();const offset=y-box.top-box.height/2;if(offset<0&&offset>closest.offset){return{offset:offset,element:child};}else{return closest;}},{offset:Number.NEGATIVE_INFINITY}).element;}